<% layout('../layout') -%>


<br>
<br>
<p class="text-center index-display"><a href= <%= donations[0].website_url%> ><img src="<%=donations[0].image%>"/></p></a>
<p class="text-center fonttitle"><a href= <%= donations[0].website_url%> ><%= donations[0].name%></a></p>
<p class="text-center"><%= donations[0].description%></p>
<p class="text-center">
  <b>Address: </b><%=donations[0].address.street%>
                  <%=donations[0].address.city%>
                  <%=donations[0].address.state%>
                  <%=donations[0].address.zip%>
</p>
<p class="text-center">
  <b>Phone: </b><%=donations[0].contactUs%>
</p>
<p class="text-center">
  <b>Hours: </b><%=donations[0].hours%>
</p>


<div id="map">

  <script>

    function initMap() {
      // var directionsService = new google.maps.DirectionsService;
      // var directionsDisplay = new google.maps.DirectionsRenderer;
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 11,
        center: {lat: 26.268383, lng: -98.219369}
      });

      // var trafficLayer = new google.maps.TrafficLayer();
      //         trafficLayer.setMap(map);

      // var infoWindow = new google.maps.InfoWindow({map: map});
      //
      // if (navigator.geolocation) {
      //   navigator.geolocation.getCurrentPosition(function(position) {
      //     var pos = {
      //       lat: position.coords.latitude,
      //       lng: position.coords.longitude
      //     };
      //
      //     infoWindow.setPosition(pos);
      //     infoWindow.setContent('Location found.');
      //     map.setCenter(pos);
      //   }, function() {
      //     handleLocationError(true, infoWindow, map.getCenter());
      //   });
      // }
      //
      // else {
      //   handleLocationError(false, infoWindow, map.getCenter());
      // }

      // var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

      var markers = locations.map(function(location, i) {
        return new google.maps.Marker({
          position: location,
          // label: labels[i % labels.length]
        });
      });

      var markerCluster = new MarkerClusterer(map, markers,{
        imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'
      });

    }

    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
      infoWindow.setPosition(pos);
      infoWindow.setContent(browserHasGeolocation ?
                            'Error: The Geolocation service failed.' :
                            'Error: Your browser doesn\'t support geolocation.');
    }

    var locations = [<%=donations[0].location%>,{lat: 26.268383, lng: -98.219369}];

    var directionsService = new google.maps.DirectionsService;
    var directionsDisplay = new google.maps.DirectionsRenderer;
    function calculateAndDisplayRoute(directionsService, directionsDisplay) {
        directionsService.route({
          origin: locations[0].value,
          destination: locations[1].value,
          travelMode: 'DRIVING'
        }, function(response, status) {
          if (status === 'OK') {
            directionsDisplay.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
      }

  </script>

  <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>

  <script async defer src="https://maps.googleapis.com/maps/api/js?key=<%= key%>&callback=initMap"></script>

</div>

<%= donations%>
